BuildStamp=main.BuildStamp=$(shell date '+%Y-%m-%d_%I:%M:%S%p')
GitHash=main.GitHash=$(shell git rev-parse HEAD)
target=exploit

all: clean wget convert compile
	./release/${target}
wget:
	wget https://raw.githubusercontent.com/offensive-security/exploit-database/master/files_exploits.csv
	wget https://raw.githubusercontent.com/offensive-security/exploit-database/master/files_shellcodes.csv
convert:
	sqlite3 exploit.db < files_exploits.sql
	sqlite3 exploit.db < files_shellcodes.sql
compile: clean
	mkdir release
	go build -o ./release/${target} -ldflags "-s -w -X ${BuildStamp} -X ${GitHash}" main.go
clean:
	-rm -rf *.csv *.db *.json release 